const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./WQ_poPip.js","./BZE3hbdB.js","./entry.U7my1EZN.css","./BxYqoW90.js"])))=>i.map(i=>d[i]);
import{f as v,g as _,j as f,l as C,a5 as J,c as d,H as h,a6 as z,a7 as G,_ as K}from"./BZE3hbdB.js";import{t as Y}from"./BxYqoW90.js";const Z=["fill"],Be={__name:"Bookmark",props:{filled:{type:Boolean,default:!1}},setup(t){return(e,r)=>(_(),v("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:t.filled?"currentColor":"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-bookmark"},r[0]||(r[0]=[f("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"},null,-1)]),8,Z))}},X={},ee={xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"};function te(t,e){return _(),v("svg",ee,e[0]||(e[0]=[f("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"},null,-1),f("line",{x1:"16",y1:"2",x2:"16",y2:"6"},null,-1),f("line",{x1:"8",y1:"2",x2:"8",y2:"6"},null,-1),f("line",{x1:"3",y1:"10",x2:"21",y2:"10"},null,-1)]))}const Ee=C(X,[["render",te]]),ne={},oe={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"};function re(t,e){return _(),v("svg",oe,e[0]||(e[0]=[f("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)]))}const Ae=C(ne,[["render",re]]),se={},ae={xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"};function le(t,e){return _(),v("svg",ae,e[0]||(e[0]=[f("path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z"},null,-1)]))}const De=C(se,[["render",le]]),ie={},ce={xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"};function ue(t,e){return _(),v("svg",ce,e[0]||(e[0]=[f("path",{d:"M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"},null,-1),f("line",{x1:"7",y1:"7",x2:"7.01",y2:"7"},null,-1)]))}const Ne=C(ie,[["render",ue]]),Ie=t=>new Date(t).toLocaleDateString("fa-IR",{year:"numeric",month:"long",day:"numeric"}),Le=t=>{var e;return((e=t.meta)==null?void 0:e.readingTime)||1},de=t=>{if(!t)return[];const e=new Set;return t.forEach(r=>{var s;return(s=r.tags)==null?void 0:s.forEach(l=>e.add(l))}),Array.from(e).sort()},me=t=>t?[...new Set(t.map(e=>{var r;return(r=e.meta)==null?void 0:r.category}).filter(Boolean))].sort():[],ge=(t,e,r)=>e?t:t==null?void 0:t.slice(0,r),fe=(t,e)=>Math.max(0,((t==null?void 0:t.length)||0)-e),N={newest:(t,e)=>new Date(e.date)-new Date(t.date),oldest:(t,e)=>new Date(t.date)-new Date(e.date),title:(t,e)=>t.title.localeCompare(e.title),popular:(t,e)=>new Date(e.date)-new Date(t.date)},p={bookmarks:"bookmarkedPosts",comments:"postComments"},Oe=J("blog",()=>{const t=d(""),e=d("newest"),r=d("grid"),s=d(null),l=d(null),n=d(!1),a=d(5),c=d([]),u=d([]),y=d(null),m=d({}),I=()=>{{const o=localStorage.getItem(p.bookmarks);o&&(c.value=JSON.parse(o))}},L=()=>{{const o=localStorage.getItem(p.comments);o&&(m.value=JSON.parse(o))}},S=()=>{localStorage.setItem(p.comments,JSON.stringify(m.value))},O=(o,i)=>{m.value[o]||(m.value[o]=[]),m.value[o].push({...i,id:Date.now(),date:new Date().toISOString()}),S()},R=(o,i)=>{m.value[o]&&(m.value[o]=m.value[o].filter(g=>g.id!==i),S())},j=o=>m.value[o]||[],M=o=>{y.value=o},b=o=>{var i,g;return typeof o=="string"?o:o&&typeof o=="object"?o.id||o._id||o.slug||((i=o.path)==null?void 0:i.replace(/^\/blog\//,""))||((g=o._path)==null?void 0:g.replace(/^\/blog\//,"")):(console.error("Invalid post or slug provided:",o),"")},B=o=>{const i=b(o);return i?c.value.includes(i):!1},P=o=>{const i=b(o);if(!i)return;const g=c.value.indexOf(i);g>-1?c.value.splice(g,1):c.value.push(i),localStorage.setItem(p.bookmarks,JSON.stringify(c.value))},x=h(()=>{if(!u.value)return[];const o=t.value.toLowerCase();return u.value.filter(i=>{var E,A,D;const g=!t.value||i.title.toLowerCase().includes(o)||((E=i.description)==null?void 0:E.toLowerCase().includes(o)),Q=!s.value||((A=i.tags)==null?void 0:A.includes(s.value)),q=!l.value||((D=i.meta)==null?void 0:D.category)===l.value,H=e.value!=="popular"||B(i);return g&&Q&&q&&H})}),V=h(()=>x.value?[...x.value].sort(N[e.value]||N.newest):[]),T=h(()=>de(u.value)),F=h(()=>me(u.value)),U=h(()=>ge(T.value,n.value,a.value)),W=h(()=>fe(T.value,a.value));return{searchQuery:t,sortOption:e,viewType:r,selectedTag:s,selectedCategory:l,showAllTags:n,maxVisibleTags:a,bookmarkedPosts:c,allPosts:u,isDarkMode:y,comments:m,filteredPosts:x,sortedFilteredPosts:V,allTags:T,allCategories:F,visibleTags:U,remainingTagsCount:W,initBookmarks:I,initComments:L,addComment:O,deleteComment:R,getPostComments:j,initDarkMode:M,setAllPosts:o=>{u.value=o},isBookmarked:B,toggleBookmark:P,toggleShowAllTags:()=>{n.value=!n.value},setViewType:o=>{r.value=o},setSearchQuery:o=>{t.value=o},setSortOption:o=>{e.value=o},toggleTag:o=>{s.value=s.value===o?null:o},toggleCategory:o=>{l.value=l.value===o?null:o},resetFilters:()=>{t.value="",s.value=null,l.value=null}}}),k=(t,e)=>{const r=t._conditions;return r.length>0?`(${r.join(` ${e} `)})`:""},$=t=>{const e=[],r={_conditions:e,where(s,l,n){let a;switch(l.toUpperCase()){case"IN":case"NOT IN":if(Array.isArray(n)){const c=n.map(u=>w(u)).join(", ");a=`"${String(s)}" ${l.toUpperCase()} (${c})`}else throw new TypeError(`Value for ${l} must be an array`);break;case"BETWEEN":case"NOT BETWEEN":if(Array.isArray(n)&&n.length===2)a=`"${String(s)}" ${l.toUpperCase()} ${w(n[0])} AND ${w(n[1])}`;else throw new Error(`Value for ${l} must be an array with two elements`);break;case"IS NULL":case"IS NOT NULL":a=`"${String(s)}" ${l.toUpperCase()}`;break;case"LIKE":case"NOT LIKE":a=`"${String(s)}" ${l.toUpperCase()} ${w(n)}`;break;default:a=`"${String(s)}" ${l} ${w(typeof n=="boolean"?Number(n):n)}`}return e.push(`${a}`),r},andWhere(s){const l=s($());return e.push(k(l,"AND")),r},orWhere(s){const l=s($());return e.push(k(l,"OR")),r}};return r},he=(t,e)=>{const r={conditions:[],selectedFields:[],offset:0,limit:0,orderBy:[],count:{field:"",distinct:!1}},s={__params:r,andWhere(n){const a=n($());return r.conditions.push(k(a,"AND")),s},orWhere(n){const a=n($());return r.conditions.push(k(a,"OR")),s},path(n){return s.where("path","=",z(n))},skip(n){return r.offset=n,s},where(n,a,c){return s.andWhere(u=>u.where(String(n),a,c)),s},limit(n){return r.limit=n,s},select(...n){return n.length&&r.selectedFields.push(...n),s},order(n,a){return r.orderBy.push(`"${String(n)}" ${a}`),s},async all(){return e(t,l()).then(n=>n||[])},async first(){return e(t,l({limit:1})).then(n=>n[0]||null)},async count(n="*",a=!1){return e(t,l({count:{field:String(n),distinct:a}})).then(c=>c[0].count)}};function l(n={}){let a="SELECT ";if(n!=null&&n.count)a+=`COUNT(${n.count.distinct?"DISTINCT ":""}${n.count.field}) as count`;else{const u=Array.from(new Set(r.selectedFields));a+=u.length>0?u.map(y=>`"${String(y)}"`).join(", "):"*"}a+=` FROM ${Y[String(t)]}`,r.conditions.length>0&&(a+=` WHERE ${r.conditions.join(" AND ")}`),r.orderBy.length>0?a+=` ORDER BY ${r.orderBy.join(", ")}`:a+=" ORDER BY stem ASC";const c=(n==null?void 0:n.limit)||r.limit;return c>0&&(r.offset>0?a+=` LIMIT ${c} OFFSET ${r.offset}`:a+=` LIMIT ${c}`),a}return s};function w(t){return`'${String(t).replace(/'/g,"''")}'`}const Re=t=>{var r,s;const e=(s=(r=G())==null?void 0:r.ssrContext)==null?void 0:s.event;return he(t,(l,n)=>we(e,l,n))};async function we(t,e,r){return ve(e,r)}async function ve(t,e){return await K(()=>import("./WQ_poPip.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(s=>s.loadDatabaseAdapter(t)).then(s=>s.all(e))}export{Be as _,Ee as a,Ae as b,Le as c,De as d,Ne as e,Ie as f,Re as q,Oe as u};
