const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./3nVnLiDI.js","./CJ01OeqY.js","./entry.D2xz95q6.css","./CN8ODLBc.js"])))=>i.map(i=>d[i]);
import{f as k,g as $,j as h,l as S,a3 as J,c as d,G as f,a4 as H,a5 as K,_ as Y}from"./CJ01OeqY.js";import{t as z}from"./CN8ODLBc.js";const Z=["fill"],Se={__name:"Bookmark",props:{filled:{type:Boolean,default:!1}},setup(e){return(t,r)=>($(),k("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:e.filled?"currentColor":"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-bookmark"},r[0]||(r[0]=[h("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"},null,-1)]),8,Z))}},X={},ee={xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"};function te(e,t){return $(),k("svg",ee,t[0]||(t[0]=[h("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"},null,-1),h("line",{x1:"16",y1:"2",x2:"16",y2:"6"},null,-1),h("line",{x1:"8",y1:"2",x2:"8",y2:"6"},null,-1),h("line",{x1:"3",y1:"10",x2:"21",y2:"10"},null,-1)]))}const xe=S(X,[["render",te]]),ne={},oe={xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"};function re(e,t){return $(),k("svg",oe,t[0]||(t[0]=[h("path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z"},null,-1)]))}const be=S(ne,[["render",re]]),se={},ae={xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"};function le(e,t){return $(),k("svg",ae,t[0]||(t[0]=[h("path",{d:"M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"},null,-1),h("line",{x1:"7",y1:"7",x2:"7.01",y2:"7"},null,-1)]))}const Be=S(se,[["render",le]]),Ee=e=>new Date(e).toLocaleDateString("fa-IR",{year:"numeric",month:"long",day:"numeric"}),Ae=e=>{var t;return((t=e.meta)==null?void 0:t.readingTime)||1},ie=e=>{if(!e)return[];const t=new Set;return e.forEach(r=>{var s;return(s=r.tags)==null?void 0:s.forEach(l=>t.add(l))}),Array.from(t).sort()},ce=e=>e?[...new Set(e.map(t=>{var r;return(r=t.meta)==null?void 0:r.category}).filter(Boolean))].sort():[],ue=(e,t,r)=>t?e:e==null?void 0:e.slice(0,r),de=(e,t)=>Math.max(0,((e==null?void 0:e.length)||0)-t),N={newest:(e,t)=>new Date(t.date)-new Date(e.date),oldest:(e,t)=>new Date(e.date)-new Date(t.date),title:(e,t)=>e.title.localeCompare(t.title),popular:(e,t)=>new Date(t.date)-new Date(e.date)},y={bookmarks:"bookmarkedPosts",comments:"postComments"},De=J("blog",()=>{const e=d(""),t=d("newest"),r=d("grid"),s=d(null),l=d(null),n=d(!1),a=d(5),c=d([]),u=d([]),v=d(null),m=d({}),I=()=>{{const o=localStorage.getItem(y.bookmarks);o&&(c.value=JSON.parse(o))}},L=()=>{{const o=localStorage.getItem(y.comments);o&&(m.value=JSON.parse(o))}},x=()=>{localStorage.setItem(y.comments,JSON.stringify(m.value))},O=(o,i)=>{m.value[o]||(m.value[o]=[]),m.value[o].push({...i,id:Date.now(),date:new Date().toISOString()}),x()},R=(o,i)=>{m.value[o]&&(m.value[o]=m.value[o].filter(g=>g.id!==i),x())},j=o=>m.value[o]||[],P=o=>{v.value=o},b=o=>{var i,g;return typeof o=="string"?o:o&&typeof o=="object"?o.id||o._id||o.slug||((i=o.path)==null?void 0:i.replace(/^\/blog\//,""))||((g=o._path)==null?void 0:g.replace(/^\/blog\//,"")):(console.error("Invalid post or slug provided:",o),"")},B=o=>{const i=b(o);return i?c.value.includes(i):!1},V=o=>{const i=b(o);if(!i)return;const g=c.value.indexOf(i);g>-1?c.value.splice(g,1):c.value.push(i),localStorage.setItem(y.bookmarks,JSON.stringify(c.value))},C=f(()=>{if(!u.value)return[];const o=e.value.toLowerCase();return u.value.filter(i=>{var E,A,D;const g=!e.value||i.title.toLowerCase().includes(o)||((E=i.description)==null?void 0:E.toLowerCase().includes(o)),Q=!s.value||((A=i.tags)==null?void 0:A.includes(s.value)),q=!l.value||((D=i.meta)==null?void 0:D.category)===l.value,G=t.value!=="popular"||B(i);return g&&Q&&q&&G})}),M=f(()=>C.value?[...C.value].sort(N[t.value]||N.newest):[]),T=f(()=>ie(u.value)),F=f(()=>ce(u.value)),U=f(()=>ue(T.value,n.value,a.value)),W=f(()=>de(T.value,a.value));return{searchQuery:e,sortOption:t,viewType:r,selectedTag:s,selectedCategory:l,showAllTags:n,maxVisibleTags:a,bookmarkedPosts:c,allPosts:u,isDarkMode:v,comments:m,filteredPosts:C,sortedFilteredPosts:M,allTags:T,allCategories:F,visibleTags:U,remainingTagsCount:W,initBookmarks:I,initComments:L,addComment:O,deleteComment:R,getPostComments:j,initDarkMode:P,setAllPosts:o=>{u.value=o},isBookmarked:B,toggleBookmark:V,toggleShowAllTags:()=>{n.value=!n.value},setViewType:o=>{r.value=o},setSearchQuery:o=>{e.value=o},setSortOption:o=>{t.value=o},toggleTag:o=>{s.value=s.value===o?null:o},toggleCategory:o=>{l.value=l.value===o?null:o},resetFilters:()=>{e.value="",s.value=null,l.value=null}}}),_=(e,t)=>{const r=e._conditions;return r.length>0?`(${r.join(` ${t} `)})`:""},p=e=>{const t=[],r={_conditions:t,where(s,l,n){let a;switch(l.toUpperCase()){case"IN":case"NOT IN":if(Array.isArray(n)){const c=n.map(u=>w(u)).join(", ");a=`"${String(s)}" ${l.toUpperCase()} (${c})`}else throw new TypeError(`Value for ${l} must be an array`);break;case"BETWEEN":case"NOT BETWEEN":if(Array.isArray(n)&&n.length===2)a=`"${String(s)}" ${l.toUpperCase()} ${w(n[0])} AND ${w(n[1])}`;else throw new Error(`Value for ${l} must be an array with two elements`);break;case"IS NULL":case"IS NOT NULL":a=`"${String(s)}" ${l.toUpperCase()}`;break;case"LIKE":case"NOT LIKE":a=`"${String(s)}" ${l.toUpperCase()} ${w(n)}`;break;default:a=`"${String(s)}" ${l} ${w(typeof n=="boolean"?Number(n):n)}`}return t.push(`${a}`),r},andWhere(s){const l=s(p());return t.push(_(l,"AND")),r},orWhere(s){const l=s(p());return t.push(_(l,"OR")),r}};return r},me=(e,t)=>{const r={conditions:[],selectedFields:[],offset:0,limit:0,orderBy:[],count:{field:"",distinct:!1}},s={__params:r,andWhere(n){const a=n(p());return r.conditions.push(_(a,"AND")),s},orWhere(n){const a=n(p());return r.conditions.push(_(a,"OR")),s},path(n){return s.where("path","=",H(n))},skip(n){return r.offset=n,s},where(n,a,c){return s.andWhere(u=>u.where(String(n),a,c)),s},limit(n){return r.limit=n,s},select(...n){return n.length&&r.selectedFields.push(...n),s},order(n,a){return r.orderBy.push(`"${String(n)}" ${a}`),s},async all(){return t(e,l()).then(n=>n||[])},async first(){return t(e,l({limit:1})).then(n=>n[0]||null)},async count(n="*",a=!1){return t(e,l({count:{field:String(n),distinct:a}})).then(c=>c[0].count)}};function l(n={}){let a="SELECT ";if(n!=null&&n.count)a+=`COUNT(${n.count.distinct?"DISTINCT ":""}${n.count.field}) as count`;else{const u=Array.from(new Set(r.selectedFields));a+=u.length>0?u.map(v=>`"${String(v)}"`).join(", "):"*"}a+=` FROM ${z[String(e)]}`,r.conditions.length>0&&(a+=` WHERE ${r.conditions.join(" AND ")}`),r.orderBy.length>0?a+=` ORDER BY ${r.orderBy.join(", ")}`:a+=" ORDER BY stem ASC";const c=(n==null?void 0:n.limit)||r.limit;return c>0&&(r.offset>0?a+=` LIMIT ${c} OFFSET ${r.offset}`:a+=` LIMIT ${c}`),a}return s};function w(e){return`'${String(e).replace(/'/g,"''")}'`}const Ne=e=>{var r,s;const t=(s=(r=K())==null?void 0:r.ssrContext)==null?void 0:s.event;return me(e,(l,n)=>ge(t,l,n))};async function ge(e,t,r){return he(t,r)}async function he(e,t){return await Y(()=>import("./3nVnLiDI.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(s=>s.loadDatabaseAdapter(e)).then(s=>s.all(t))}export{Se as _,xe as a,be as b,Ae as c,Be as d,Ee as f,Ne as q,De as u};
